(()=>{"use strict";class e{constructor(e,t,s){this._name=e.name,this._link=e.link,this._cardTemplate=t,this._handleImageClick=s}_getTemplate(){return document.querySelector(this._cardTemplate).content.querySelector(".element").cloneNode(!0)}_setEventListeners(){this._elementLikeButton.addEventListener("click",(()=>this._handleLikeClick())),this._elementDeleteButton.addEventListener("click",(()=>this._handleDeleteClick())),this._elementImage.addEventListener("click",(()=>this._handleImageClick(this._name,this._link)))}_handleLikeClick(){this._elementLikeButton.classList.toggle("element__like_active")}_handleDeleteClick(){this._card.remove(),this._card=null}generateCard(){return this._card=this._getTemplate(),this._elementImage=this._card.querySelector(".element__image"),this._elementTitle=this._card.querySelector(".element__title"),this._elementLikeButton=this._card.querySelector(".element__like"),this._elementDeleteButton=this._card.querySelector(".element__delete"),this._fillCard(),this._setEventListeners(),this._card}_fillCard=()=>{this._elementImage.src=this._link,this._elementImage.alt=this._name,this._elementTitle.textContent=this._name}}class t{constructor(e,t){this._form=t,this._config=e,this._buttonSave=this._form.querySelector(this._config.submitButtonSelector),this._inputList=Array.from(this._form.querySelectorAll(this._config.inputSelector))}enableValidation(){this._setEventListeners()}disableSubmitButton(){this._buttonSave.classList.remove(this._config.activeButtonClass),this._buttonSave.classList.add(this._config.inactiveButtonClass),this._buttonSave.disabled=!0}enableSubmitButton(){this._buttonSave.classList.add(this._config.activeButtonClass),this._buttonSave.classList.remove(this._config.inactiveButtonClass),this._buttonSave.disabled=!1}_showInputError(e){const t=this._form.querySelector(`.${e.id}-error`);t.classList.add(this._config.errorClass),t.textContent=e.validationMessage,e.classList.add(this._config.inputErrorClass)}_hideInputError(e){const t=this._form.querySelector(`.${e.id}-error`);t.classList.remove(this._config.errorClass),t.textContent="",e.classList.remove(this._config.inputErrorClass)}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_hasInvalidInput(){return this._inputList.some((e=>!e.validity.valid))}_toggleButtonState(){this._hasInvalidInput()?this.disableSubmitButton():this.enableSubmitButton()}_setEventListeners(){this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}}class s{constructor(e){this._popup=document.querySelector(e),this._buttonClose=this._popup.querySelector(".popup__button-close"),this._handleEscClose=this._handleEscClose.bind(this),this._handleCloseByOverlay=this._handleCloseByOverlay.bind(this)}open(){document.addEventListener("keydown",this._handleEscClose),this._popup.classList.add("popup_opened")}close(){this._popup.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose(e){"Escape"===e.key&&this.close()}_handleCloseByOverlay(e){e.target.classList.contains("popup_opened")&&this.close()}setEventListeners(){this._popup.addEventListener("mouseup",this._handleCloseByOverlay),this._buttonClose.addEventListener("click",(()=>{this.close()}))}}class i extends s{constructor(e,t){super(e),this._callbackSubmit=t,this._form=this._popup.querySelector(".popup__form"),this._inputs=[...this._form.querySelectorAll(".popup__input")]}_getInputValues(){const e={};return this._inputs.forEach((t=>{e[t.name]=t.value})),e}close(){super.close(),this._form.reset()}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(e=>{e.preventDefault(),this._callbackSubmit(this._getInputValues())}))}}const n={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_type_disabled",activeButtonClass:"popup__button_valid",inputErrorClass:"popup__input-error_type_active",errorClass:"error"},o=document.querySelector(".profile__edit-button"),r=document.querySelector(".profile__add-button"),l=document.forms.formProfile,a=document.forms.formAddCard,c=l.elements.inputName,u=l.elements.inputJob;function _(t){return new e(t,"#templateCards",(()=>v.open(t))).generateCard()}const p=new class{constructor({titleSelector:e,subtitleSelector:t}){this._title=document.querySelector(e),this._subtitle=document.querySelector(t)}getUserInfo(){return{title:this._title.textContent,subtitle:this._subtitle.textContent}}setUserInfo(e,t){this._title.textContent=e,this._subtitle.textContent=t}}({titleSelector:".profile__title",subtitleSelector:".profile__text"}),d=new i(".popup_type_edit",(function(e){p.setUserInfo(e.inputName,e.inputJob),d.close()}));d.setEventListeners();const h=new class{constructor({renderer:e},t){this._renderer=e,this._container=document.querySelector(t)}addItem=e=>{this._container.prepend(e)};renderItems(e){e.forEach((e=>this._renderer(e)))}}({renderer:e=>h.addItem(_(e))},".elements"),m=new i(".popup_type_add",(e=>{h.addItem(_(e)),m.close()}));m.setEventListeners();const v=new class extends s{constructor(e){super(e),this._imagePopup=this._popup.querySelector(".popup__card-image"),this._imagePopupTitle=this._popup.querySelector(".popup__card-title")}open=e=>{this._imagePopupTitle.textContent=e.name,this._imagePopup.alt=e.name,this._imagePopup.src=e.link,super.open()}}(".popup_type_big-card");v.setEventListeners();const b=new t(n,l);b.enableValidation();const f=new t(n,a);f.enableValidation(),o.addEventListener("click",(()=>function(){const{title:e,subtitle:t}=p.getUserInfo();c.value=e,u.value=t,b.disableSubmitButton(),d.open()}())),r.addEventListener("click",(()=>(f.disableSubmitButton(),void m.open()))),h.renderItems([{name:"Архыз",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg",alt:"Архыз"},{name:"Челябинская область",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg",alt:"Челябинская область"},{name:"Иваново",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg",alt:"Иваново"},{name:"Камчатка",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg",alt:"Камчатка"},{name:"Холмогорский район",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg",alt:"Холмогорский район"},{name:"Байкал",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg",alt:"Байкал"}].reverse())})();